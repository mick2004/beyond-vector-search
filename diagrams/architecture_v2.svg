<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1100 560" width="1100" height="560" role="img" aria-label="Adaptive retrieval router (3 strategies) architecture diagram">
  <defs>
    <marker id="arrow" viewBox="0 0 10 10" refX="9.5" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="rgba(255,255,255,0.75)"/>
    </marker>
    <style>
      .bg { fill: #0b1020; }
      .box { fill: rgba(255,255,255,0.06); stroke: rgba(255,255,255,0.20); stroke-width: 1.2; }
      .route { fill: rgba(122,162,247,0.12); stroke: rgba(122,162,247,0.60); stroke-width: 1.2; }
      .build { fill: rgba(158,206,106,0.12); stroke: rgba(158,206,106,0.60); stroke-width: 1.2; }
      .label { fill: rgba(255,255,255,0.92); font: 650 14px ui-sans-serif, system-ui; }
      .small { fill: rgba(255,255,255,0.72); font: 12px ui-sans-serif, system-ui; }
      .arrow { stroke: rgba(255,255,255,0.72); stroke-width: 2.2; fill: none; marker-end: url(#arrow); }
      .arrowR { stroke: rgba(122,162,247,0.85); stroke-width: 2.2; fill: none; marker-end: url(#arrow); }
      .arrowG { stroke: rgba(158,206,106,0.85); stroke-width: 2.2; fill: none; marker-end: url(#arrow); }
      .dashed { stroke-dasharray: 7 7; }
    </style>
  </defs>

  <rect class="bg" x="0" y="0" width="1100" height="560"/>

  <!-- Online path -->
  <rect class="box" x="40" y="56" width="185" height="78" rx="14"/>
  <text class="label" x="60" y="88">User Query</text>
  <text class="small" x="60" y="112">NL + IDs + jargon</text>

  <rect class="route" x="270" y="46" width="220" height="98" rx="14"/>
  <text class="label" x="290" y="78">Router</text>
  <text class="small" x="290" y="100">features + learned weights</text>
  <text class="small" x="290" y="120">chooses strategy per query</text>

  <!-- 3 retrievers -->
  <rect class="box" x="540" y="26" width="240" height="78" rx="14"/>
  <text class="label" x="560" y="56">Vector Retriever</text>
  <text class="small" x="560" y="80">char n-gram TF‑IDF</text>

  <rect class="box" x="540" y="122" width="240" height="78" rx="14"/>
  <text class="label" x="560" y="152">Keyword Retriever</text>
  <text class="small" x="560" y="176">BM25-like scoring</text>

  <rect class="box" x="540" y="218" width="240" height="78" rx="14"/>
  <text class="label" x="560" y="248">Hybrid Retriever</text>
  <text class="small" x="560" y="272">blend keyword + vector</text>

  <rect class="build" x="840" y="78" width="220" height="78" rx="14"/>
  <text class="label" x="860" y="108">Context Builder</text>
  <text class="small" x="860" y="132">top‑k passages</text>

  <rect class="build" x="840" y="178" width="220" height="78" rx="14"/>
  <text class="label" x="860" y="208">Answer Generator</text>
  <text class="small" x="860" y="232">template / LLM</text>

  <!-- Offline loop -->
  <rect class="box" x="540" y="356" width="240" height="84" rx="14"/>
  <text class="label" x="560" y="388">Evaluator</text>
  <text class="small" x="560" y="412">hit@k + answer proxy</text>

  <rect class="box" x="270" y="356" width="220" height="84" rx="14"/>
  <text class="label" x="290" y="388">Feedback Store</text>
  <text class="small" x="290" y="412">router weights/state</text>

  <rect class="box" x="840" y="356" width="220" height="84" rx="14"/>
  <text class="label" x="860" y="388">Telemetry Store</text>
  <text class="small" x="860" y="412">Delta (DBX) or SQLite</text>

  <!-- Arrows -->
  <path class="arrow" d="M 225 95 L 270 95"/>
  <path class="arrowR" d="M 490 78 L 540 65"/>
  <path class="arrowR dashed" d="M 490 100 L 540 160"/>
  <path class="arrowR dashed" d="M 490 122 L 540 256"/>

  <path class="arrow" d="M 780 65 L 840 117"/>
  <path class="arrow" d="M 780 160 L 840 117"/>
  <path class="arrow" d="M 780 256 L 840 117"/>

  <path class="arrowG" d="M 950 156 L 950 178"/>
  <path class="arrow" d="M 950 256 L 950 356"/>

  <!-- Eval feedback -->
  <path class="arrow" d="M 950 256 C 950 310 740 320 660 356"/>
  <path class="arrowG" d="M 660 440 L 380 440"/>
  <path class="arrowG dashed" d="M 380 356 C 380 280 380 190 380 144"/>

  <text class="small" x="40" y="532">Key: add more retrievers as arms; route online, score arms offline, update weights safely.</text>
</svg>


