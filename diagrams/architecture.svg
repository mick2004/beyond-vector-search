<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1040 520" width="1040" height="520" role="img" aria-label="Adaptive retrieval router architecture diagram">
  <defs>
    <linearGradient id="boxFill" x1="0" x2="0" y1="0" y2="1">
      <stop offset="0%" stop-color="rgba(255,255,255,0.08)"/>
      <stop offset="100%" stop-color="rgba(255,255,255,0.04)"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="10" stdDeviation="12" flood-color="rgba(0,0,0,0.45)"/>
    </filter>
    <marker id="arrow" viewBox="0 0 10 10" refX="9.5" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="rgba(255,255,255,0.65)"/>
    </marker>
    <style>
      .box { fill: url(#boxFill); stroke: rgba(255,255,255,0.22); stroke-width: 1.2; rx: 14; filter: url(#shadow); }
      .box2 { fill: rgba(122,162,247,0.10); stroke: rgba(122,162,247,0.55); stroke-width: 1.3; rx: 14; filter: url(#shadow); }
      .box3 { fill: rgba(158,206,106,0.10); stroke: rgba(158,206,106,0.55); stroke-width: 1.3; rx: 14; filter: url(#shadow); }
      .label { fill: rgba(255,255,255,0.92); font: 650 14px ui-sans-serif, system-ui; }
      .small { fill: rgba(255,255,255,0.70); font: 12px ui-sans-serif, system-ui; }
      .arrow { stroke: rgba(255,255,255,0.60); stroke-width: 2.2; fill: none; marker-end: url(#arrow); }
      .arrow2 { stroke: rgba(122,162,247,0.80); stroke-width: 2.2; fill: none; marker-end: url(#arrow); }
      .arrow3 { stroke: rgba(158,206,106,0.80); stroke-width: 2.2; fill: none; marker-end: url(#arrow); }
      .dashed { stroke-dasharray: 7 7; }
      .cap { fill: rgba(255,255,255,0.62); font: 11px ui-sans-serif, system-ui; }
    </style>
  </defs>

  <!-- Background -->
  <rect x="0" y="0" width="1040" height="520" fill="#0b1020"/>

  <!-- Main flow boxes -->
  <rect class="box" x="40" y="52" width="170" height="70" rx="14" />
  <text class="label" x="60" y="82">User Query</text>
  <text class="small" x="60" y="104">Natural language / IDs</text>

  <rect class="box2" x="260" y="42" width="200" height="90" rx="14" />
  <text class="label" x="280" y="74">Router</text>
  <text class="small" x="280" y="96">features + learned bias</text>
  <text class="small" x="280" y="116">selects strategy per query</text>

  <rect class="box" x="520" y="18" width="220" height="90" rx="14" />
  <text class="label" x="540" y="50">Vector Retriever</text>
  <text class="small" x="540" y="72">char n-gram TF‑IDF</text>
  <text class="small" x="540" y="92">fuzzy similarity</text>

  <rect class="box" x="520" y="134" width="220" height="90" rx="14" />
  <text class="label" x="540" y="166">Keyword Retriever</text>
  <text class="small" x="540" y="188">BM25-like scoring</text>
  <text class="small" x="540" y="208">exact match bias</text>

  <rect class="box3" x="790" y="62" width="210" height="80" rx="14" />
  <text class="label" x="810" y="92">Context Builder</text>
  <text class="small" x="810" y="114">top‑k passages</text>

  <rect class="box3" x="790" y="170" width="210" height="80" rx="14" />
  <text class="label" x="810" y="200">Answer Generator</text>
  <text class="small" x="810" y="222">template-based</text>

  <!-- Eval / feedback loop -->
  <rect class="box" x="520" y="300" width="220" height="85" rx="14" />
  <text class="label" x="540" y="332">Evaluator</text>
  <text class="small" x="540" y="354">hit@k + exact match</text>
  <text class="small" x="540" y="374">(toy proxy)</text>

  <rect class="box" x="260" y="300" width="200" height="85" rx="14" />
  <text class="label" x="280" y="332">Feedback Store</text>
  <text class="small" x="280" y="354">router weights</text>
  <text class="small" x="280" y="374">(+ eval history)</text>

  <rect class="box" x="790" y="300" width="210" height="85" rx="14" />
  <text class="label" x="810" y="332">Logging / Telemetry</text>
  <text class="small" x="810" y="354">Delta/SQLite: query,</text>
  <text class="small" x="810" y="374">strategy, score</text>

  <!-- Arrows: online path -->
  <path class="arrow" d="M 210 87 L 260 87" />
  <text class="cap" x="220" y="74">request</text>

  <path class="arrow2" d="M 460 70 L 520 60" />
  <text class="cap" x="468" y="54">route (vector)</text>
  <path class="arrow2 dashed" d="M 460 104 L 520 170" />
  <text class="cap" x="468" y="136">route (keyword)</text>

  <path class="arrow" d="M 740 72 L 790 102" />
  <path class="arrow" d="M 740 180 L 790 202" />

  <path class="arrow3" d="M 895 142 L 895 170" />
  <text class="cap" x="905" y="162">context → answer</text>

  <!-- Arrow: logging -->
  <path class="arrow" d="M 895 250 L 895 300" />
  <text class="cap" x="905" y="286">log run</text>

  <!-- Evaluation loop -->
  <path class="arrow" d="M 895 250 C 895 270 740 270 630 300" />
  <text class="cap" x="760" y="274">evaluate (offline)</text>

  <path class="arrow3" d="M 630 385 L 360 385" />
  <text class="cap" x="470" y="402">write feedback</text>

  <path class="arrow3" d="M 360 300 C 360 250 360 180 360 132" />
  <text class="cap" x="372" y="210">update policy</text>

  <path class="arrow3 dashed" d="M 360 132 C 360 120 360 110 360 100" />

  <text class="small" x="40" y="500">Key idea: routing is a decision problem; evaluation feeds back into routing weights over time.</text>
</svg>



